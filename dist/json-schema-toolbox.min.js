"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("lodash"),t=require("lodash/fp");function r(e,t){return{...e,default:t}}const n={type:"string"},i=r(n,""),u={type:"boolean"},o=r(u,!0),s=r(u,!1);function c(e,t=[]){return{type:"array",default:t,items:e}}function a(e){return void 0!==e}function f(t,r){switch(t.type){case"object":return function(t,r){const n=e.omitBy(r,e.isUndefined);if(e.isEmpty(n))return null;const i={};r&&e.forOwn(r,((e,t)=>{a(e)&&(i[t]=e)}));return e.forOwn(t.properties,((t,n)=>{if(t.required||a(r)&&a(r[n])){const u=e.isUndefined(r)?void 0:r[n];i[n]=f(t,u)}})),i}(t,r);case"array":return function(t,r){if(e.isUndefined(r))return t.default?t.default:void 0;const n=[];if(t.items)for(const e of r)n.push(f(t.items,e));return n}(t,r);case"number":return function(t,r){if(a(r)&&!e.isNull(r)&&""!==r)return e.isString(r)&&e.includes(r,",")&&(r=e.replace(r,/,/g,".")),Number(r)}(0,r);case"string":return function(t,r){return e.isUndefined(r)||e.isString(r)?r:String(r)}(0,r);case"date":return function(t,r){return e.isUndefined(r)||"-"===r?t.default:r}(t,r);default:return r}}const d=t.curryN(2,((e,t)=>f(e,t)));function p(e){return null!=e}function l(e,t,r,n){return e.type===r&&typeof t!==n}function m(t,r){switch(t.type){case"object":return function(t,r){const n={};e.forOwn(t.properties,((i,u)=>{if(e.isArray(t.required)&&t.required.indexOf(u)>=0||p(r)&&p(r[u])){const e=p(r)?r[u]:void 0;n[u]=m(i,e)}})),r&&e.forOwn(r,((e,t)=>{!p(n[t])&&p(e)&&(n[t]=e)}));return n}(t,r);case"array":return function(e,t){if(null==t)return e.default?e.default:[];const r=[];for(let n=0;n<t.length;n++)r.push(m(e.items,t[n]));return r}(t,r);default:return p(r)?l(t,r,"string","string")?String(r):l(t,r,"number","number")||l(t,r,"integer","number")?Number(r):r:p(t.default)?t.default:"integer"===t.type?0:void 0}}function y(e,t){return m(t,e)}const h=t.curryN(2,((e,t)=>y(t,e))),x=t.curryN(2,((e,t)=>y(t,c(e))));exports.arraySchema=c,exports.booleanSchema=u,exports.dateSchema={type:"date"},exports.emptyStringSchema=i,exports.enumSchema=function(e,t){return{type:"string",enum:e,default:t}},exports.exactSchema=function(e){return{...e,additionalProperties:!1}},exports.falseSchema=s,exports.fillDefaults=h,exports.fillDefaultsArray=x,exports.limitedStringSchema=e=>({type:"string",maxLength:e}),exports.normalizeToSave=d,exports.numberSchema={type:"number"},exports.objectSchema=function(e={},t={}){return{type:"object",properties:e,default:t}},exports.omitId=function(t){return e.omit(t,["id","title","default"])},exports.requiredSchema=function(t){return{...t,required:e.keys(t.properties),additionalProperties:!1}},exports.schemaDefault=r,exports.schemaRequired=function(e,t){return{...e,required:t}},exports.stringSchema=n,exports.trueSchema=o,exports.withId=function(e,t){return{...e,id:t}};
